<!DOCTYPE html>
<html lang="zxx">
  <head>
    <meta charset="UTF-8" />
    <meta name="description" content="Male_Fashion Template" />
    <meta name="keywords" content="Male_Fashion, unica, creative, html" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Cửa hàng thời trang T&P</title>

    <!-- Google Font -->
    <link
      href="https://fonts.googleapis.com/css2?family=Nunito+Sans:wght@300;400;600;700;800;900&display=swap"
      rel="stylesheet"
    />

    <!-- Css Styles -->
    <link rel="stylesheet" href="css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="css/font-awesome.min.css" type="text/css" />
    <link rel="stylesheet" href="css/elegant-icons.css" type="text/css" />
    <link rel="stylesheet" href="css/magnific-popup.css" type="text/css" />
    <link rel="stylesheet" href="css/nice-select.css" type="text/css" />
    <link rel="stylesheet" href="css/owl.carousel.min.css" type="text/css" />
    <link rel="stylesheet" href="css/slicknav.min.css" type="text/css" />
    <link rel="stylesheet" href="css/style.css" type="text/css" />
  </head>

  <body>

       <!-- Page Preloder -->
       <div id="preloder">
        <div class="loader"></div>
    </div>

    <!-- Offcanvas Menu Begin -->
    <div class="offcanvas-menu-overlay"></div>
    <div class="offcanvas-menu-wrapper">
      <div class="offcanvas__option">
        <div class="offcanvas__links">
          <a href="#" onclick="dangnhap()">Đăng nhập</a>
          <a href="#">Đăng ký</a>
        </div>
      </div>
      <div class="offcanvas__nav__option">
        <a href="#" class="search-switch"
          ><img src="img/icon/search.png" alt=""
        /></a>
        <a href="#"><img src="img/icon/heart.png" alt="" /></a>
        <a href="./giohang.html"><img src="img/icon/cart.png" alt="" id="slspgh" />dqwdqwqwdqw</a>
        <div class="price"><span id="ttmenu"></span></div>
      </div>
      <div id="mobile-menu-wrap"></div>
      <div class="offcanvas__text">
        <p>
          Miễn phí vận chuyển, hoàn trả trong 30 ngày hoặc đảm bảo hoàn lại
          tiền.
        </p>
      </div>
    </div>
    <!-- Offcanvas Menu End -->

      <!-- Header Section Begin -->
      <header class="header">
        <!-- <div class="header__top">
          <div class="container">
            <div class="row">
              <div class="col-lg-6 col-md-7">
                <div class="header__top__left">
                  <p>
                    Miễn phí vận chuyển, hoàn trả trong 30 ngày hoặc đảm bảo hoàn
                    lại tiền.
                  </p>
                </div>
              </div>
              <div class="col-lg-6 col-md-5">
                <div class="header__top__right">
                  <div class="header__top__links">
                    <a href="#">Đăng nhập</a>
                    <a href="#">Đăng ký</a>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div> -->
        <div class="container">
          <div class="row">
            <div class="col-lg-3 col-md-3">
              <div class="header__logo">
                <a href="./index.html"><img src="img/logo.png" alt="" /></a>
              </div>
            </div>
            <div class="col-lg-6 col-md-6">
              <nav class="header__menu mobile-menu">
                <ul>
                  <li class="active"><a href="./index.html">Trang chủ</a></li>
                  <li>
                    <a href="./shop.html">Sản phẩm</a>
                    <ul class="dropdown" id="drop_menu"></ul>
                  </li>
                  <!-- <li><a href="#">Pages</a>
                                  <ul class="dropdown">
                                      <li><a href="./about.html">About Us</a></li>
                                      <li><a href="./shop-details.html">Shop Details</a></li>
                                      <li><a href="./shopping-cart.html">Shopping Cart</a></li>
                                      <li><a href="./checkout.html">Check Out</a></li>
                                      <li><a href="./blog-details.html">Blog Details</a></li>
                                  </ul>
                              </li> -->
                  <li><a href="./blog.html">Tin tức</a></li>
                  <li><a href="./contact.html">Liên hệ</a></li>
                </ul>
              </nav>
            </div>
            <div class="col-lg-3 col-md-3">
              <div class="header__nav__option">
              
                  <form action="timkiem.html">
                      <input type="text" placeholder="Tìm kiếm sản phẩm" name="search_product" required="không được bỏ trống">
                      <button type="submit" name="search_button"><img src="img/icon/search.png" alt=""/></button>
                      <a href="./giohang.html" id="hienThiSoLuong"><img src="img/icon/cart.png" alt="" /></a>
                    </form>
                                  
              </div>
            </div>
          </div>
          <div class="canvas__open"><i class="fa fa-bars"></i></div>
        </div>
      </header>
      <!-- Header Section End -->

    <!-- Breadcrumb Section Begin -->
    <section class="breadcrumb-option">
        <div class="container">
            <div class="row">
                <div class="col-lg-12">
                    <div class="breadcrumb__text">
                        <h4>Giỏ hàng</h4>
                        <div class="breadcrumb__links">
                            <a href="./index.html">Trang chủ</a>
                            <a href="./shop.html">Sản phẩm</a>
                            <span>Giỏ hàng</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <!-- Breadcrumb Section End -->

    <!-- Shopping Cart Section Begin -->
    <section class="shopping-cart spad">
        <div class="container">
            <div class="row">
                <div class="col-lg-8" style=" margin: 0 auto;" >
                    <div class="shopping__cart__table">
                        <table id="tbl_cart">
                            <thead>
                                <tr>
                                    <th>Sản phẩm</th>
                                    <th>Số lượng</th>
                                    <th>Size</th>
                                    <th>Tổng</th>
                                    <th></th>
                                </tr>
                            </thead>
                            <tbody>
                                    <!-- các sản phẩm trong giỏ hàng  -->
                            </tbody>
                        </table>
                    </div>
                    <div class="row">
                        <div class="col-lg-6 col-md-6 col-sm-6" id="adu"> 
                            <div class="continue__btn" id="ttmh">
                                <a href="index.html" >Tiếp tục mua hàng</a>
                            </div>
                        </div>
                        <div class="col-lg-6 col-md-6 col-sm-6">
                            <div class="continue__btn update__btn" id="xtt">
                                <a href="" onclick="removeItemCart()" ><i class="fa fa-spinner" ></i> Xóa tất cả</a>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-4" id="tt">         
                    <div class="cart__total">
                        <h6>Tổng giỏ hàng</h6>
                        <ul>
                            <li>Tổng thanh toán: <span id="tongtien"></span></li>
                         
                        </ul>
                        <a href="#" class="primary-btn" id="thanhtoan">Thanh toán</a>
                         
                    </div>
                </div>
            </div>
        </div>
    </section>
    <!-- Shopping Cart Section End -->

  
    <!-- Footer Section Begin -->
    <footer class="footer">
        <div class="container">
            <div class="row">
                <div class="col-lg-3 col-md-6 col-sm-6">
                    <div class="footer__about">
                        <div class="footer__logo">
                            <a href="#"><img src="img/footer-logo.png" alt=""></a>
                        </div>
                        <p>Khách hàng là trọng tâm của mô hình kinh doanh độc đáo của chúng tôi, bao gồm cả thiết kế.</p>
                        <a href="#"><img src="img/payment.png" alt=""></a>
                    </div>
                </div>
                <div class="col-lg-2 offset-lg-1 col-md-3 col-sm-6">
                    <div class="footer__widget">
                        <h6>Sản phẩm</h6>
                        <ul id="show_pro_footer">
                           
                        </ul>
                    </div>
                </div>
                <div class="col-lg-2 col-md-3 col-sm-6">
                    <div class="footer__widget">
                        <h6>Dịch vụ</h6>
                        <ul>
                            <li><a href="#">Liên hệ với chúng tôi</a></li>
                            <li><a href="#">Phương thức thanh toán</a></li>
                            <li><a href="#">Vận chuyển</a></li>
                            <li><a href="#">Trả lại & Trao đổi</a></li>
                        </ul>
                    </div>
                </div>
                <div class="col-lg-3 offset-lg-1 col-md-6 col-sm-6">
                    <div class="footer__widget">
                        <h6>Nhận thông báo</h6>
                        <div class="footer__newslatter">
                            <p>Hãy là người đầu tiên biết về hàng mới xuất hiện, xem sách, bán hàng và quảng cáo!</p>
                            <form action="#">
                                <input type="text" placeholder="Nhập email của bạn">
                                <button type="submit"><span class="icon_mail_alt"></span></button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-lg-12 text-center">
                    <div class="footer__copyright__text">
                        <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
                        <p>Bản quyền thuộc Thành Phú ©
                            <script>
                                document.write(new Date().getFullYear());
                            </script> 
                        
                        </p>
                        <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
                    </div>
                </div>
            </div>
        </div>
    </footer>
    <!-- Footer Section End -->

    <!-- Search Begin -->
    <div class="search-model">
        <div class="h-100 d-flex align-items-center justify-content-center">
            <div class="search-close-switch">+</div>
            <form class="search-model-form">
                <input type="text" id="search-input" placeholder="Search here.....">
            </form>
        </div>
    </div>
    <!-- Search End -->

    <!-- Js Plugins -->
    <script src="js/jquery-3.3.1.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/jquery.nice-select.min.js"></script>
    <script src="js/jquery.nicescroll.min.js"></script>
    <script src="js/jquery.magnific-popup.min.js"></script>
    <script src="js/jquery.countdown.min.js"></script>
    <script src="js/jquery.slicknav.js"></script>
    <script src="js/mixitup.min.js"></script>
    <script src="js/owl.carousel.min.js"></script>
    <script src="js/main.js"></script>
</body>

</html>

<script>
    // lấy danh sách catagory
    var url = "http://localhost:3000/Category";

    fetch(url).then( data => data.json()) // ko nói gì hết là dùng phương thức get
    .then (category => {
       cat_arr =  category.map( cat =>{
            return ` <li><a href="#">${cat.name}</a></li> `
        }).join("")
        // cat_arr.push(`<li><a href ='./giohang.html'>giỏ hàng</a></li>`)
        document.querySelector('#drop_menu').innerHTML+= cat_arr
        document.querySelector("#show_pro_footer").innerHTML = cat_arr;
    })

</script>

<script>
    // hiển thị giỏ hàng
    var cart = JSON.parse (localStorage.getItem("cart"))

    if( cart){
        cart.forEach( (sp, index) => {  // biến đầu nhận value của cart biến thứ 2 nhận các chỉ số của cart
        document.querySelector("#tbl_cart").innerHTML+=`
            <tr>
                <td class="product__cart__item">
                    <div class="product__cart__item__pic" style = "width:116px;height:116px">
                        <a href="chitietsp.html?id=${sp.id}&id_cate=${sp.cate_id}"><img src="${sp.image}" alt=""> </a>      
                    </div>
                    <div class="product__cart__item__text">
                        <a href="chitietsp.html?id=${sp.id}&id_cate=${sp.cate_id}"><h6>${sp.name}</h6></a> 
                        <h5 class="gia">${sp.price.toLocaleString('vi', {style : 'currency', currency : 'VND'})}</h5>
                    </div>
                </td>
                <td class="quantity__item">
                    <div class="quantity">
                        <div class="pro-qty-2">
                            <input min="1" type="text" value="${sp.quantity}" 
                                onkeyup = "tinhtien(${sp.price}, this.value, ${index})"
                            >
                        </div>  
                    </div>
                </td>   
                <td >${sp.size.toUpperCase()}</td>
                <td class="cart__price tien">${sp.quantity * sp.price} đ</td>
                <td class="cart__close" style="cursor: pointer; " onclick="return confirm('bạn có muốn xóa sản phẩm này không?')"><a href ="" onclick = "xoaTungSanPham(${index})" ><i class="fa fa-close"></i></a></td>
            </tr> 
        `
    });} else {

        document.querySelector("#tbl_cart").innerHTML = ` 
           
            <tr>

                <td class="product__cart__item">

                    <h3 style="  text-align: center; font-size: 40px; font-weight: 800;">Giỏ hàng trống<h3>

                    <div class="col-lg-6 col-md-6 col-sm-6" style = "margin-top: 4%; margin-left: 29%;" >
                    
                        <div class="continue__btn" id="ttmh">

                            <a href="index.html">Tiếp tục mua hàng</a>

                        </div>

                    </div>


                </td>   

            </tr> 

        `

        var t =  document.querySelector("#tt");

        t.style.display = "none"

        var xtt =  document.querySelector("#xtt");

        xtt.style.display = "none"  
           
        var a =   document.querySelector("#adu");

        a.style.display = "none"  
           
    }

</script>
<script>
    // tính tiền khi tăng giảm số lượng

    function tinhtien(gia, soluong, i){

       tien =  gia * soluong;

       var cart = JSON.parse (localStorage.getItem("cart"))

       cart[i].quantity = soluong;

       localStorage.setItem("cart", JSON.stringify(cart));
       
       document.getElementsByClassName("tien")[i].innerText = tien;

       tinhtongtien();

    }

</script>

<script>
    // tính tổng tiền

    function tinhtongtien (){

        arrTien = document.getElementsByClassName("tien");

        console.log(arrTien)
        
        tongTien = 0;

        for (let t of  arrTien){

            tongTien +=parseInt(t.innerText)

        }
       
        document.querySelector("#tongtien").innerText = tongTien.toLocaleString('vi', {style : 'currency', currency : 'VND'});
       
        return tongTien 
        
    }

    tinhtongtien()

</script>


<script>
    
    // thanh toán

    document.querySelector("#thanhtoan").onclick = function(){

        document.location="./thanhtoan.html"

    }

</script>


    <script>  

        // xóa sản phẩm trong giỏ hàng

        function removeItemCart(){

            localStorage.removeItem("cart")
            
        }
       
        function xoaTungSanPham(index){

            var cart = JSON.parse (localStorage.getItem("cart"))
           
            cart.splice(index,1)

            localStorage.setItem("cart",JSON.stringify(cart))
         
        }
        
    

    </script>

    <script>
    
        // hiện số lượng sp

        var cart = JSON.parse (localStorage.getItem("cart"))
    
        var hg =  cart.length;
    
        document.querySelector("#hienThiSoLuong").innerHTML+=`<span>${hg}</span>`
    
    </script>